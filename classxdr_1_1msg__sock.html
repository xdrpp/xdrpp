<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>xdrpp: xdr::msg_sock Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">xdrpp
   </div>
   <div id="projectbrief">RFC4506 XDR compiler and message library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacexdr.html">xdr</a></li><li class="navelem"><a class="el" href="classxdr_1_1msg__sock.html">msg_sock</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-attribs">Static Public Attributes</a> &#124;
<a href="classxdr_1_1msg__sock-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">xdr::msg_sock Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Send and receive a series of delimited messages on a stream socket.  
 <a href="classxdr_1_1msg__sock.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="msgsock_8h_source.html">msgsock.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:a841d404ffd30102b4d4af48f212bde9a"><td class="memItemLeft" align="right" valign="top"><a id="a841d404ffd30102b4d4af48f212bde9a"></a>
using&#160;</td><td class="memItemRight" valign="bottom"><b>rcb_t</b> = std::function&lt; void(msg_ptr)&gt;</td></tr>
<tr class="separator:a841d404ffd30102b4d4af48f212bde9a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a63e3489ee88dadd3df62b6c2b742adb7"><td class="memTemplParams" colspan="2"><a id="a63e3489ee88dadd3df62b6c2b742adb7"></a>
template&lt;typename T &gt; </td></tr>
<tr class="memitem:a63e3489ee88dadd3df62b6c2b742adb7"><td class="memTemplItemLeft" align="right" valign="top">&#160;</td><td class="memTemplItemRight" valign="bottom"><b>msg_sock</b> (<a class="el" href="classxdr_1_1pollset.html">pollset</a> &amp;ps, <a class="el" href="structxdr_1_1sock__t.html">sock_t</a> s, T &amp;&amp;rcb, size_t maxmsglen=default_maxmsglen)</td></tr>
<tr class="separator:a63e3489ee88dadd3df62b6c2b742adb7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a65bbb8dbc1afe5ce6bd629fdbfb5cf2f"><td class="memItemLeft" align="right" valign="top"><a id="a65bbb8dbc1afe5ce6bd629fdbfb5cf2f"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>msg_sock</b> (<a class="el" href="classxdr_1_1pollset.html">pollset</a> &amp;ps, <a class="el" href="structxdr_1_1sock__t.html">sock_t</a> s)</td></tr>
<tr class="separator:a65bbb8dbc1afe5ce6bd629fdbfb5cf2f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a66e110379cc1cff0fd8bec1cfb4cdf1c"><td class="memItemLeft" align="right" valign="top"><a id="a66e110379cc1cff0fd8bec1cfb4cdf1c"></a>
<a class="el" href="classxdr_1_1msg__sock.html">msg_sock</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>operator=</b> (<a class="el" href="classxdr_1_1msg__sock.html">msg_sock</a> &amp;&amp;)=delete</td></tr>
<tr class="separator:a66e110379cc1cff0fd8bec1cfb4cdf1c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ccfc3ec540c66aea84242dcbf19b38e"><td class="memTemplParams" colspan="2"><a id="a4ccfc3ec540c66aea84242dcbf19b38e"></a>
template&lt;typename T &gt; </td></tr>
<tr class="memitem:a4ccfc3ec540c66aea84242dcbf19b38e"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><b>setrcb</b> (T &amp;&amp;rcb)</td></tr>
<tr class="separator:a4ccfc3ec540c66aea84242dcbf19b38e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a46285320cb2b58de2be3661fd62c26a7"><td class="memItemLeft" align="right" valign="top"><a id="a46285320cb2b58de2be3661fd62c26a7"></a>
size_t&#160;</td><td class="memItemRight" valign="bottom"><b>wsize</b> () const</td></tr>
<tr class="separator:a46285320cb2b58de2be3661fd62c26a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade62221d6a65d8c13d5af7fde8fd932a"><td class="memItemLeft" align="right" valign="top"><a id="ade62221d6a65d8c13d5af7fde8fd932a"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>putmsg</b> (msg_ptr &amp;b)</td></tr>
<tr class="separator:ade62221d6a65d8c13d5af7fde8fd932a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a25410afc4fe5ee081977449ea3fbf0c9"><td class="memItemLeft" align="right" valign="top"><a id="a25410afc4fe5ee081977449ea3fbf0c9"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>putmsg</b> (msg_ptr &amp;&amp;b)</td></tr>
<tr class="separator:a25410afc4fe5ee081977449ea3fbf0c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5b122e8e9f089533554ad62fe0de499"><td class="memItemLeft" align="right" valign="top">std::shared_ptr&lt; const bool &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classxdr_1_1msg__sock.html#aa5b122e8e9f089533554ad62fe0de499">destroyed_ptr</a> () const</td></tr>
<tr class="memdesc:aa5b122e8e9f089533554ad62fe0de499"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns pointer to a <code>bool</code> that becomes <code>true</code> once the <a class="el" href="classxdr_1_1msg__sock.html" title="Send and receive a series of delimited messages on a stream socket. ">msg_sock</a> has been deleted.  <a href="#aa5b122e8e9f089533554ad62fe0de499">More...</a><br /></td></tr>
<tr class="separator:aa5b122e8e9f089533554ad62fe0de499"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa2e6f067f230997216b1a37118dff757"><td class="memItemLeft" align="right" valign="top"><a id="aa2e6f067f230997216b1a37118dff757"></a>
<a class="el" href="classxdr_1_1pollset.html">pollset</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>get_pollset</b> ()</td></tr>
<tr class="separator:aa2e6f067f230997216b1a37118dff757"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b386363e81486bf400f3faea326499c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structxdr_1_1sock__t.html">sock_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classxdr_1_1msg__sock.html#a1b386363e81486bf400f3faea326499c">get_sock</a> () const</td></tr>
<tr class="memdesc:a1b386363e81486bf400f3faea326499c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the socket, but do not do IO on it.  <a href="#a1b386363e81486bf400f3faea326499c">More...</a><br /></td></tr>
<tr class="separator:a1b386363e81486bf400f3faea326499c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-attribs"></a>
Static Public Attributes</h2></td></tr>
<tr class="memitem:a155434809bd7e7127e8e456babf5ca0d"><td class="memItemLeft" align="right" valign="top"><a id="a155434809bd7e7127e8e456babf5ca0d"></a>
static constexpr std::size_t&#160;</td><td class="memItemRight" valign="bottom"><b>default_maxmsglen</b> = 0x100000</td></tr>
<tr class="separator:a155434809bd7e7127e8e456babf5ca0d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Send and receive a series of delimited messages on a stream socket. </p>
<p>The format (specified in RFC5531, Section 11) is simple: A 4-byte length (in little-endian format) followed by that many bytes. The implementation is optimized for having many sockets each receiving a small number of messages, as opposed to receiving many messages over the same socket.</p>
<p>Currently this calls read once or twice per message to get the exact length before allocating buffer space and reading the message body (possibly including the next message length). This could be fixed to read at least a little bit more data speculatively and reduce the number of system calls. </p>

<p class="definition">Definition at line <a class="el" href="msgsock_8h_source.html#l00027">27</a> of file <a class="el" href="msgsock_8h_source.html">msgsock.h</a>.</p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="aa5b122e8e9f089533554ad62fe0de499"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa5b122e8e9f089533554ad62fe0de499">&#9670;&nbsp;</a></span>destroyed_ptr()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::shared_ptr&lt;const bool&gt; xdr::msg_sock::destroyed_ptr </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns pointer to a <code>bool</code> that becomes <code>true</code> once the <a class="el" href="classxdr_1_1msg__sock.html" title="Send and receive a series of delimited messages on a stream socket. ">msg_sock</a> has been deleted. </p>

<p class="definition">Definition at line <a class="el" href="msgsock_8h_source.html#l00051">51</a> of file <a class="el" href="msgsock_8h_source.html">msgsock.h</a>.</p>

</div>
</div>
<a id="a1b386363e81486bf400f3faea326499c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1b386363e81486bf400f3faea326499c">&#9670;&nbsp;</a></span>get_sock()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structxdr_1_1sock__t.html">sock_t</a> xdr::msg_sock::get_sock </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns the socket, but do not do IO on it. </p>
<p>This is just for calling things like <code>getpeername</code>. </p>

<p class="definition">Definition at line <a class="el" href="msgsock_8h_source.html#l00055">55</a> of file <a class="el" href="msgsock_8h_source.html">msgsock.h</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>xdrpp/<a class="el" href="msgsock_8h_source.html">msgsock.h</a></li>
<li>xdrpp/<a class="el" href="msgsock_8cc_source.html">msgsock.cc</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Sep 24 2017 21:38:49 for xdrpp by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
